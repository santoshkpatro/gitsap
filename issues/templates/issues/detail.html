{% extends 'shared/project_base.html' %}
{% load humanize %}

{% block styles %}
<style>
    .issue-status {
        font-size: 0.875rem;
        font-weight: 500;
    }

    .meta-label {
        font-size: 0.85rem;
        font-weight: 500;
        color: #6c757d;
    }
</style>
{% endblock styles %}

{% block content %}
<div class="container mt-2">
    <!-- Top Section -->
    <div class="d-flex justify-content-between align-items-center mb-2">
        <h4 class="fw-semibold mb-0 text-dark">
            {{ issue.title }}
            <span class="text-secondary">
                #{{ issue.issue_number }}
            </span>
        </h4>
        <div class="d-flex align-items-center gap-2">
            <a href="#"
                class="btn btn-sm btn-outline-primary edit-btn {% if request.user != issue.author %}disabled{% endif %}">
                <i data-lucide="edit-3" class="me-1" style="width: 16px;"></i> Edit
            </a>
        </div>
    </div>

    <!-- Meta Info -->
    <div class="d-flex align-items-center gap-2 mb-2">
        <i data-lucide="{% if issue.status == 'open' %}circle{% else %}check{% endif %}" class="text-primary"
            style="width: 16px;"></i>
        <span class="badge bg-primary issue-status text-light">{{ issue.get_status_display }}</span>
        <span class="text-muted small">Opened {{ issue.created_at|naturaltime }} by <strong>
                {{ issue.author.username }}</strong></span>
    </div>

    <hr class="my-3" />

    <!-- Grid Layout -->
    <div class="row">
        <!-- Left: Summary -->
        <div class="col-lg-9 mb-4">
            <div class="meta-label d-flex align-items-center gap-1 mb-2">
                <i data-lucide="align-left" style="width: 16px;"></i>
                Summary
            </div>
            <div class="bg-white border rounded p-3">
                {% if issue.summary_html %}
                {{ issue.summary_html|safe }}
                {% else %}
                <p class="text-muted mb-0">No summary provided.</p>
                {% endif %}
            </div>
        </div>

        <!-- Right: Sidebar -->
        <div class="col-lg-3">
            <!-- Assignees -->
            <div class="rounded p-3 mb-3">
                <div class="meta-label d-flex align-items-center gap-1 mb-2">
                    <i data-lucide="user" style="width: 16px;"></i>
                    Assignees
                </div>
                {% if issue.assignees.all %}
                <ul class="list-unstyled small mb-0">
                    {% for user in issue.assignees.all %}
                    <li class="d-flex align-items-center gap-1 mb-1">
                        <i data-lucide="circle-user" style="width: 14px;"></i>
                        {{ user.get_display_name }}
                    </li>
                    {% endfor %}
                </ul>
                {% else %}
                <p class="text-muted small mb-0">No assignees</p>
                {% endif %}
            </div>

            <!-- Labels -->
            <div class="rounded p-3">
                <div class="meta-label d-flex align-items-center gap-1 mb-2">
                    <i data-lucide="tag" style="width: 16px;"></i>
                    Labels
                </div>
                <p class="text-muted small mb-0">No labels</p>
            </div>
        </div>
    </div>
</div>
{% endblock content %}